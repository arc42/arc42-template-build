services:
  builder:
    container_name: arc42-template-builder
    build:
      context: .
      dockerfile: docker/Dockerfile
    volumes:
      # Mount the template repository (read-only)
      - ./arc42-template:/workspace/arc42-template:ro
      # Mount the configuration file (read-only)
      - ./config/build.yaml:/app/config/build.yaml:ro
      # Mount output directories (read-write)
      - ./workspace/build:/workspace/build
      - ./workspace/dist:/workspace/dist
      - ./workspace/logs:/workspace/logs
    environment:
      - LOG_LEVEL=${LOG_LEVEL:-INFO}
    # The command to run inside the container, passed to the ENTRYPOINT.
    # Use `make build` to run this.
    # To run with other arguments, use:
    # docker-compose run --rm builder build --lang EN --format pdf
    command: build --all